## mysql


```

mkdir -p /opt/docker/mysql/conf/
mkdir -p /opt/docker/mysql/logs/
mkdir -p /opt/docker/mysql/data/

# 拷贝一份配置文件，先随便启动一个镜像
docker run -p 3306:3306 --name mysql -e MYSQL_ROOT_PASSWORD=123456  -d mysql:8.0.32
 
# 启动成功后，进入容器内部拷贝配置文件，到宿主主机
docker cp  mysql:/etc/mysql /opt/docker/mysql/conf
 
# 删除刚才的容器，重新创建容器
# 先停止容器
docker stop mysql
 
# 再删除容器
docker rm mysql
 
 docker run  -itd  -p 3306:3306 --name mysql -e character-set-server=utf8mb4 --privileged=true  --restart unless-stopped  -v /opt/docker/mysql/conf/mysql:/etc/mysql  -v /opt/docker/mysql/logs:/logs  -v /opt/docker/mysql/data:/var/lib/mysql -v /etc/localtime:/etc/localtime  -e MYSQL_ROOT_PASSWORD=123456  -d mysql:8.0.32 --lower_case_table_names=1
```



```
# 进入容器
docker exec -it mysql /bin/bash
 
# 打开MySQL 命令行 密码 123456
mysql -uroot -p
 
use mysql;
 
# 创建账户
CREATE USER 'adminx'@'%' IDENTIFIED BY '123456';
 
# 授权账户
GRANT ALL ON *.* TO 'adminx'@'%';
 
# 刷新权限
 
FLUSH PRIVILEGES;

exit
cd /etc/mysql/conf.d


cd /opt/docker/mysql/conf/mysql/conf.d/mysql.cnf 
[client]
default-character-set=utf8mb4
[mysql]
default-character-set=utf8mb4
[mysqld]
# 跳过密码登录
#skip-grant-tables
#bind-address = 127.0.0.1
init_connect='SET collation_connection = utf8mb4_general_ci'
init_connect='SET NAMES utf8mb4'
character-set-server=utf8mb4
collation-server=utf8mb4_general_ci
skip-character-set-client-handshake
lower_case_table_names=1


docker restart mysql
```

## redis

```
docker pull redis:6.2.6

mkdir -p /opt/docker/redis/conf
mkdir -p /opt/docker/redis/data 
```



```
bind 0.0.0.0
protected-mode yes
port 6379
tcp-backlog 511
timeout 0
tcp-keepalive 300
pidfile /var/run/redis_6379.pid
loglevel notice
databases 16
always-show-logo no
set-proc-title yes
proc-title-template "{title} {listen-addr} {server-mode}"
stop-writes-on-bgsave-error yes
rdbcompression yes
rdbchecksum yes
dbfilename dump.rdb
rdb-del-sync-files no
dir ./
replica-serve-stale-data yes
replica-read-only yes
repl-diskless-sync no
repl-diskless-sync-delay 5
repl-diskless-load disabled
repl-disable-tcp-nodelay no
replica-priority 100
requirepass 654321
acllog-max-len 128
lazyfree-lazy-eviction no
lazyfree-lazy-expire no
lazyfree-lazy-server-del no
replica-lazy-flush no
lazyfree-lazy-user-del no
lazyfree-lazy-user-flush no
oom-score-adj no
oom-score-adj-values 0 200 800
disable-thp yes
appendonly no
appendfilename "appendonly.aof"
appendfsync everysec
no-appendfsync-on-rewrite no
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb
aof-load-truncated yes
aof-use-rdb-preamble yes
lua-time-limit 5000
slowlog-log-slower-than 10000
slowlog-max-len 128
latency-monitor-threshold 0
notify-keyspace-events ""
hash-max-ziplist-entries 512
hash-max-ziplist-value 64
list-max-ziplist-size -2
list-compress-depth 0
set-max-intset-entries 512
zset-max-ziplist-entries 128
zset-max-ziplist-value 64
hll-sparse-max-bytes 3000
stream-node-max-bytes 4096
stream-node-max-entries 100
activerehashing yes
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60
hz 10
dynamic-hz yes
aof-rewrite-incremental-fsync yes
rdb-save-incremental-fsync yes
jemalloc-bg-thread yes
```

```
docker run -p 6379:6379 --name redis -v /opt/docker/redis/conf/redis.conf:/etc/redis/redis.conf -v /opt/docker/redis/data:/data -v /opt/docker/redis/logs:/logs -d redis:6.2.6 redis-server /etc/redis/redis.conf

docker update --restart=always redis
```

## rabbit

```
docker pull rabbitmq:management
docker run -d -p 5672:5672 -p 15672:15672 -p 15674:15674  -p 5671:5671  -p 15671:15671 --name rabbit -e RABBITMQ_DEFAULT_USER=admin -e RABBITMQ_DEFAULT_PASS=admin rabbitmq:management

#查看版本号
docker inspect rabbitmq:management

#下载插件
https://www.rabbitmq.com/community-plugins.html
#上传到/root下
docker cp /root/rabbitmq_delayed_message_exchange-4.1.0.ez rabbit:/plugins
docker restart rabbit

```

## elasticsearch8和kibana,带ik分词器

```
docker pull elasticsearch:8.4.1
docker pull kibana:8.4.1
docker network create es-net
docker run --name es -p 9200:9200 -p 9300:9300 \
-e "discovery.type=single-node" \
-e ES_JAVA_OPTS="-Xms512m -Xmx512m" \
-v esplugins:/usr/share/elasticsearch/plugins \
-v esdata:/usr/share/elasticsearch/data \
-v esconfig:/usr/share/elasticsearch/config \
--privileged \
--network es-net \
-it elasticsearch:8.4.1

```

## nginx

```
docker pull nginx:1.24.0
mkdir -p /opt/docker/nginx/{conf,conf.d,html,logs,ssl}
docker run --name nginx -d -p 80:80 nginx:1.24.0
docker cp nginx:/etc/nginx/nginx.conf /opt/docker/nginx/conf/ #复制配置文件
docker cp nginx:/etc/nginx/conf.d /opt/docker/nginx
docker cp nginx:/usr/share/nginx/html /opt/docker/nginx #复制基本的html界面

# 停止运行， 移除容器
docker stop nginx
docker rm nginx
docker run --name nginx -p 80:80 -p 443:443 \
    -v /opt/docker/nginx/html:/usr/share/nginx/html \
    -v /opt/docker/nginx/conf/nginx.conf:/etc/nginx/nginx.conf/ \
    -v /opt/docker/nginx/conf.d:/etc/nginx/conf.d/ \
    -v /opt/docker/nginx/logs:/var/log/nginx \
    -v /opt/docker/nginx/ssl:/etc/nginx/ssl \
    -d --restart=always nginx:1.24.0


```

```PowerShell
docker run -d \
--name nacos \
--env-file /opt/docker/nacos/custom.env \
-p 8848:8848 \
-p 9848:9848 \
-p 9849:9849 \
--restart=always \
nacos/nacos-server:v2.1.0-slim
```
